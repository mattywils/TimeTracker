<html>
	<head>
		<title>Time Sheet Calculator</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
		<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
		<style type="text/css">
			* {
				-webkit-font-smoothing: antialiased;
				color: #eaeaea;
				font-family: 'Montserrat', sans-serif;
			}

			body {
				background: -webkit-radial-gradient(#333333, #222222);
				background: -o-radial-gradient(#333333, #222222);
				background: -moz-radial-gradient(#333333, #222222);
				background: radial-gradient(#333333, #222222);
				font-size: 24px;
				text-align: center;
			}

			input, select {
				background: none;
				border: 1px dashed #eaeaea;
				border-radius: 5px;
				display: inline-block;
				font-size: 24px;
				margin: 10px;
				outline: none;
				padding: 5px 10px;
				-webkit-appearance: none;
			}

			#startTime {
				width: 90px;
			}

			select option {
				background: #333;
				color: #fff;
			}

			p {
				line-height: 36px;
			}

			button {
				color: #fff;
				background-color: #5cb85c;
				border-color: #4cae4c;
				border: 1px solid transparent;
				border-radius: 4px;
				font-size: 18px;
				margin: 5px;
				opacity: 0.90;
				padding: 6px 12px;
			}

			button:hover {
				opacity: 1.0;
			}

			button:disabled {
				background-color: #aaaaaa;
				border-color: #aaaaaa;
			}

			button:disabled:hover {
				opacity: 0.90;
			}

			.dangerBtn {
				background-color: #d9534f;
				border-color: #d43f3a;
			}

			.warningBtn {
				background-color: #f0ad4e;
				border-color: #eea236;
			}

			.table {
				display: table;
				width: 100%;
				height: 100%;
			}

			.table-cell {
				display: table-cell;
				vertical-align: middle;
			}

			.logo {
				font-size: 48px;
			}

			.logo i {
				padding-right: 10px;
			}

			.logo strong {
				color: #5bc0de;
			}

			.totals {
				list-style: none;
				font-size: 14px;
				margin-top: 35px;
				padding: 0 40px;
			}

			.totals li {
				color: #999;
				display: inline-block;
				padding-right: 30px;
			}

			.totals li:last-child {
				padding-right: 0;
			}

			.time {
				color: #777;
				padding-left: 20px;
			}
		</style>
	</head>
	<body>
		<div class="table">
			<div class="table-cell">
				<span class="logo"><i class="fa fa-clock-o"></i><strong>Time</strong>Tracker</span>
				<input type="hidden" id="startTimeMilliseconds" />
				<p>
					Since <input id="startTime" disabled> you have been working on
					<select id="activity">
						<option value="Platform">Platform</option>
						<option value="Innovation and Process/Technical Debt">Innovation and Process/Technical Debt</option>
						<option value="Operational Support">Operational Support</option>
						<option value="Production Support">Production Support</option>
						<option value="Training">Training</option>
					</select>
				</p>
				<button id="startButton"><i class="fa fa-play"></i> Start</button>
				<button id="stopButton" class="dangerBtn" disabled><i class="fa fa-stop"></i> Stop</button>
				<button id="clearButton" class="warningBtn"><i class="fa fa-eraser"></i> Clear All</button>
				<ul id="timeTotals" class="totals"></ul>
			</div>
		</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
		<script type="text/javascript">
			DisplayTotals();

			if(typeof(Storage) !== "undefined") {

				var timeSpan = { ElapsedTime: 0, Activity: "" };

				var timeSheet = {
					timeSpans: []
				};

				$("#startButton").click(function() {
					$(this).prop("disabled", true);
					$("#stopButton").prop("disabled", false);

					var d = new Date();
					$("#startTimeMilliseconds").val(d.getTime());
					$("#startTime").val(pad(d.getHours(), 2) + ':' + pad(d.getMinutes(), 2));
				});

				$("#stopButton").click(function() {
					$(this).prop("disabled", true);
					$("#startButton").prop("disabled", false);

					var startTime = $("#startTimeMilliseconds").val();
					var endTime = new Date().getTime();

					timeSpan.ElapsedTime = endTime - startTime;
					timeSpan.Activity = $("#activity").val();

					$("#startTime").val("");
					$("#activity").val("");

					if (localStorage.timeSheet) {
						var objectTimeSheet = JSON.parse(localStorage.timeSheet);
						objectTimeSheet.timeSpans.push(timeSpan);
						var stringTimeSheet = JSON.stringify(objectTimeSheet);
						localStorage.timeSheet = stringTimeSheet;
					} else {
						timeSheet.timeSpans.push(timeSpan);
						var stringTimeSheet = JSON.stringify(timeSheet);
						localStorage.timeSheet = stringTimeSheet;
					}

					DisplayTotals();
				});

				$("#clearButton").click(function() {
					if (localStorage.timeSheet) {
						localStorage.removeItem("timeSheet");
					}
					DisplayTotals();
				});

			} else {
				// Sorry! No Web Storage support..
			}

			function DisplayTotals() {
				$("#timeTotals").html("");
				if (localStorage.timeSheet) {
					var timeSheets = JSON.parse(localStorage.timeSheet);
					var platformTotals = 0;
					var InnovationTotals = 0;
					var OperationalSupportTotals = 0;
					var ProductionSupportTotals = 0;
					var TrainingTotals = 0;

					$.each(timeSheets.timeSpans, function() {
						switch(this.Activity) {
							case "Platform":
								platformTotals = platformTotals + this.ElapsedTime;
								break;
							case "Innovation and Process/Technical Debt":
								InnovationTotals = InnovationTotals + this.ElapsedTime;
								break;
							case "Operational Support":
								OperationalSupportTotals = OperationalSupportTotals + this.ElapsedTime;
								break;
							case "Production Support":
								ProductionSupportTotals = ProductionSupportTotals + this.ElapsedTime;
								break;
							case "Training":
								TrainingTotals = TrainingTotals + this.ElapsedTime;
								break;
							default:
								break;
						}
					});

					if(platformTotals > 0) {
						$("#timeTotals").append("<li>Platform:<span class='time'>" + millisecondsToHours(platformTotals) + " hours</span></li>");
					}
					if(InnovationTotals > 0) {
						$("#timeTotals").append("<li>Innovation and Process/Technical Debt:<span class='time'>" + millisecondsToHours(InnovationTotals) + " hours</span></li>");
					}
					if(OperationalSupportTotals > 0) {
						$("#timeTotals").append("<li>Operational Support:<span class='time'>" + millisecondsToHours(OperationalSupportTotals) + " hours</span></li>");
					}
					if(ProductionSupportTotals > 0) {
						$("#timeTotals").append("<li>Production Support:<span class='time'>" + millisecondsToHours(ProductionSupportTotals) + " hours</span></li>");
					}
					if(TrainingTotals > 0) {
						$("#timeTotals").append("<li>Training:<span class='time'>" + millisecondsToHours(TrainingTotals) + " hours</span></li>");
					}
				}
			}

			function pad(num, size) {
				var numString = num+"";
				while(numString.length < size) numString = "0" + numString;
				return numString;
			}

			function millisecondsToHours(milliseconds) {
				return (milliseconds / 3600000).toFixed(2);
			}
		</script>
	</body>
</html>